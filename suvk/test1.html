
<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Django-Ajax - Yuan先生 - 博客园</title>
<link type="text/css" rel="stylesheet" href="/bundles/blog-common.css?v=ChDk9h03-S75WEqNhGvXkWireJ5cCWdK1xRM9NIXfnM1"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="/skins/UnlimitedSunlight/bundle-UnlimitedSunlight.css?v=2L2gyfQfiyCwU9MzHfZxHdlKAqdUmCTHT9X4c3k8hhc1"/>
<link type="text/css" rel="stylesheet" href="/blog/customcss/262677.css?v=BdtWg3IV%2fM0hhF0e4xDcn6JkArY%3d"/>
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="/skins/UnlimitedSunlight/bundle-UnlimitedSunlight-mobile.css?v=VxC7ucUyn1xY9IlWteuEc3CgiJJILG_BSweawTmecb01"/>
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/yuanchenqi/rss"/>
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/yuanchenqi/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/yuanchenqi/wlwmanifest.xml"/>
<script src="//common.cnblogs.com/script/jquery.js" type="text/javascript"></script>  
<script type="text/javascript">var currentBlogApp = 'yuanchenqi', cb_enable_mathjax=false;var isLogined=false;</script>
<script src="/bundles/blog-common.js?v=Luc6U_bgyPg764kNG7TcM6wg6ibyyUYRDlBLbP3UdnA1" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>

<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="http://www.cnblogs.com/yuanchenqi/"><img id="blogLogo" src="/Skins/custom/images/logo.gif" alt="返回主页" /></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/yuanchenqi/">Yuan 先生!</a></h1>
<h2></h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="http://www.cnblogs.com/">博客园</a></li>
<li><a id="blog_nav_myhome" class="menu" href="http://www.cnblogs.com/yuanchenqi/">首页</a></li>
<li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
<li></li>
<li><a id="blog_nav_rss" class="menu" href="http://www.cnblogs.com/yuanchenqi/rss">订阅</a>
<!--<a id="blog_nav_rss_image" class="aHeaderXML" href="http://www.cnblogs.com/yuanchenqi/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>--></li>
<li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>
		<div class="blogStats">
			
			<div id="blog_stats">
<span id="stats_post_count">随笔 - 1&nbsp; </span>
<span id="stats_article_count">文章 - 99&nbsp; </span>
<span id="stats-comment_count">评论 - 97</span>
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
<div id="post_detail">
<!--done-->
<div id="topics">
	<div class = "post">
		<h1 class = "postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/yuanchenqi/articles/7638956.html">Django-Ajax</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body"><h1>Ajax准备知识：json</h1>
<h2>什么是json？</h2>
<p>定义：</p>
<div class="cnblogs_code">
<pre>JSON(JavaScript Object Notation, JS 对象标记) 是一种轻量级的<strong><span style="color: #ff0000;">数据交换</span></strong>格式。<br />它基于 ECMAScript (w3c制定的js规范)的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。<br />简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。 易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。</pre>
</div>
<p>讲json对象，不得不提到JS对象：</p>
<p>&nbsp;</p>
<p style="margin-left: 60px;"><img src="http://images2017.cnblogs.com/blog/877318/201708/877318-20170825211200714-1635996938.png" alt="" width="503" height="467" /></p>
<p>&nbsp;</p>
<p>合格的json对象：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('d97429f4-3219-4466-97c1-6883a9f7fc13')"><img id="code_img_closed_d97429f4-3219-4466-97c1-6883a9f7fc13" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_d97429f4-3219-4466-97c1-6883a9f7fc13" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('d97429f4-3219-4466-97c1-6883a9f7fc13',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_d97429f4-3219-4466-97c1-6883a9f7fc13" class="cnblogs_code_hide">
<pre>["one", "two", "three"<span style="color: #000000;">]

{ </span>"one": 1, "two": 2, "three": 3<span style="color: #000000;"> }

{</span>"names": ["张三", "李四"<span style="color: #000000;">] }

[ { </span>"name": "张三"}, {"name": "李四"} ]　</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;不合格的json对象：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('2222b257-7d94-4b3d-9df2-fada874d3421')"><img id="code_img_closed_2222b257-7d94-4b3d-9df2-fada874d3421" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_2222b257-7d94-4b3d-9df2-fada874d3421" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('2222b257-7d94-4b3d-9df2-fada874d3421',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_2222b257-7d94-4b3d-9df2-fada874d3421" class="cnblogs_code_hide">
<pre>{ name: "张三", 'age': 32 }                     <span style="color: #008000;">//</span><span style="color: #008000;"> 属性名必须使用双引号</span>
<span style="color: #000000;">
[</span>32, 64, 128, 0xFFF] <span style="color: #008000;">//</span><span style="color: #008000;"> 不能使用十六进制值</span>
<span style="color: #000000;">
{ </span>"name": "张三", "age": undefined }            <span style="color: #008000;">//</span><span style="color: #008000;"> 不能使用undefined</span>
<span style="color: #000000;">
{ </span>"name": "张三"<span style="color: #000000;">,
  </span>"birthday": <span style="color: #0000ff;">new</span> Date('Fri, 26 Aug 2011 07:13:10 GMT'<span style="color: #000000;">),
  </span>"getName":  <span style="color: #0000ff;">function</span>() {<span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span>.name;}    <span style="color: #008000;">//</span><span style="color: #008000;"> 不能使用函数和日期对象</span>
} 　</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<h2 id="jsonstringify">stringify与parse方法</h2>
<div class="cnblogs_code">
<pre><span style="color: #000000;">JSON.parse():     用于将一个 JSON 字符串转换为 JavaScript 对象　
eg:
console.log(JSON.parse(</span><span style="color: #800000;">'</span><span style="color: #800000;">{"name":"Yuan"}</span><span style="color: #800000;">'</span><span style="color: #000000;">));
console.log(JSON.parse(</span><span style="color: #800000;">'</span><span style="color: #800000;">{name:"Yuan"}</span><span style="color: #800000;">'</span>)) ;   //<span style="color: #000000;"> 错误
console.log(JSON.parse(</span><span style="color: #800000;">'</span><span style="color: #800000;">[12,undefined]</span><span style="color: #800000;">'</span>)) ;   //<span style="color: #000000;"> 错误



JSON.stringify(): 用于将 JavaScript 值转换为 JSON 字符串。　
eg:  console.log(JSON.stringify({</span><span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>:<span style="color: #800000;">"</span><span style="color: #800000;">egon</span><span style="color: #800000;">"</span>})) ; </pre>
</div>
<h2 class="title-text">和XML的比较</h2>
<p>JSON 格式于2001年由 Douglas Crockford 提出，目的就是取代繁琐笨重的 XML 格式。</p>
<p>JSON 格式有两个显著的优点：书写简单，一目了然；符合 JavaScript 原生语法，可以由解释引擎直接处理，不用另外添加解析代码。所以，JSON迅速被接受，已经成为各大网站交换数据的标准格式，并被写入ECMAScript 5，成为标准的一部分。</p>
<p>XML和JSON都使用结构化方法来标记数据，下面来做一个简单的比较。</p>
<p>用XML表示中国部分省市数据如下：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:html;collapse:true;;gutter:true;">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;country&gt;
    &lt;name&gt;中国&lt;/name&gt;
    &lt;province&gt;
        &lt;name&gt;黑龙江&lt;/name&gt;
        &lt;cities&gt;
            &lt;city&gt;哈尔滨&lt;/city&gt;
            &lt;city&gt;大庆&lt;/city&gt;
        &lt;/cities&gt;
    &lt;/province&gt;
    &lt;province&gt;
        &lt;name&gt;广东&lt;/name&gt;
        &lt;cities&gt;
            &lt;city&gt;广州&lt;/city&gt;
            &lt;city&gt;深圳&lt;/city&gt;
            &lt;city&gt;珠海&lt;/city&gt;
        &lt;/cities&gt;
    &lt;/province&gt;
    &lt;province&gt;
        &lt;name&gt;台湾&lt;/name&gt;
        &lt;cities&gt;
            &lt;city&gt;台北&lt;/city&gt;
            &lt;city&gt;高雄&lt;/city&gt;
        &lt;/cities&gt;
    &lt;/province&gt;
    &lt;province&gt;
        &lt;name&gt;新疆&lt;/name&gt;
        &lt;cities&gt;
            &lt;city&gt;乌鲁木齐&lt;/city&gt;
        &lt;/cities&gt;
    &lt;/province&gt;
&lt;/country&gt;
</pre>
</div>
<p>用JSON表示如下：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:html;collapse:true;;gutter:true;">{
    "name": "中国",
    "province": [{
        "name": "黑龙江",
        "cities": {
            "city": ["哈尔滨", "大庆"]
        }
    }, {
        "name": "广东",
        "cities": {
            "city": ["广州", "深圳", "珠海"]
        }
    }, {
        "name": "台湾",
        "cities": {
            "city": ["台北", "高雄"]
        }
    }, {
        "name": "新疆",
        "cities": {
            "city": ["乌鲁木齐"]
        }
    }]
}
</pre>
</div>
<p>　　可以看到，JSON 简单的语法格式和清晰的层次结构明显要比 XML 容易阅读，并且在数据交换方面，由于 JSON 所使用的字符要比 XML 少得多，可以大大得节约传输数据所占用得带宽。</p>
<p><strong>注意：</strong></p>
<div class="para">JSON格式取代了xml给网络传输带来了很大的便利,但是却没有了xml的一目了然,尤其是json数据很长的时候,我们会陷入繁琐复杂的数据节点查找中。</div>
<div class="para">但是国人的一款在线工具 BeJson 、SoJson在线工具让众多程序员、新接触JSON格式的程序员更快的了解JSON的结构，更快的精确定位JSON格式错误。</div>
<h1 class="p1">Ajax简介</h1>
<p class="p2"><span class="s1">AJAX<span class="s3">（<span class="s1">Asynchronous Javascript And XML<span class="s3">）翻译成中文就是<span class="s1">&ldquo;<span class="s3">异步<span class="s1">Javascript<span class="s3">和<span class="s1">XML&rdquo;<span class="s3">。即使用<span class="s1">Javascript<span class="s3">语言与服务器进行异步交互，传输的数据为<span class="s1">XML<span class="s3">（当然，传输的数据不只是<span class="s1">XML<span class="s3">）。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li class="li2"><span class="s3">同步交互：客户端发出一个请求后，需要等待服务器响应结束后，才能发出第二个请求；</span></li>
<li class="li3"><span class="s3">异步交互：客户端发出一个请求后，无需等待服务器响应结束，就可以发出第二个请求。</span></li>
</ul>
<p class="p3"><span class="s4">AJAX除了<strong>异步</strong>的特点外，还有一个就是：<span class="s5">浏览器页面<strong>局部刷新</strong>；（<span class="s4"><span class="s1">这一特点给用户的感受是在不知不觉中完成请求和响应过程）</span></span></span></span></p>
<p class="p3"><strong><span class="s4">js实现的局部刷新:</span></strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('451d92c8-daec-48a1-8516-43a99f89dd0a')"><img id="code_img_closed_451d92c8-daec-48a1-8516-43a99f89dd0a" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_451d92c8-daec-48a1-8516-43a99f89dd0a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('451d92c8-daec-48a1-8516-43a99f89dd0a',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_451d92c8-daec-48a1-8516-43a99f89dd0a" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html </span><span style="color: #ff0000;">lang</span><span style="color: #0000ff;">="en"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">meta </span><span style="color: #ff0000;">charset</span><span style="color: #0000ff;">="UTF-8"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>Title<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #800000;">
        .error</span><span style="background-color: #f5f5f5; color: #000000;">{</span><span style="background-color: #f5f5f5; color: #ff0000;">
            color</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #0000ff;">red
        </span><span style="background-color: #f5f5f5; color: #000000;">}</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>


<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">form </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="Form"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>姓名<span style="color: #ff0000;">&amp;nbsp;&amp;nbsp;</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="v1"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> name</span><span style="color: #0000ff;">="username"</span><span style="color: #ff0000;"> mark</span><span style="color: #0000ff;">="用户名"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>密码<span style="color: #ff0000;">&amp;nbsp;&amp;nbsp;</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="v1"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> name</span><span style="color: #0000ff;">="email"</span><span style="color: #ff0000;"> mark</span><span style="color: #0000ff;">="邮箱"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="submit"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="submit"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">form</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">src</span><span style="color: #0000ff;">="jquery-3.1.1.js"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">

    $(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">.Form :submit</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).click(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){

        flag</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #0000ff;">true</span><span style="background-color: #f5f5f5; color: #000000;">;

        $(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">Form .v1</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).each(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){

            </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> value</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">$(</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">).val();
            </span><span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (value.trim().length</span><span style="background-color: #f5f5f5; color: #000000;">==</span><span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">){
                 </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> mark</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">$(</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">).attr(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">mark</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
                 </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> $span</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">$(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">&lt;span&gt;</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
                 $span.html(mark</span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">不能为空!</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
                 $span.prop(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">class</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">error</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
                 $(</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">).after($span);

                 setTimeout(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){
                      $span.remove();
                 },</span><span style="background-color: #f5f5f5; color: #000000;">800</span><span style="background-color: #f5f5f5; color: #000000;">);

                 flag</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #0000ff;">false</span><span style="background-color: #f5f5f5; color: #000000;">;
                 </span><span style="background-color: #f5f5f5; color: #0000ff;">return</span><span style="background-color: #f5f5f5; color: #000000;"> flag;

            }
        });
        </span><span style="background-color: #f5f5f5; color: #0000ff;">return</span><span style="background-color: #f5f5f5; color: #000000;"> flag
    });


</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>


<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<h2 class="p1"><span class="s1"><span class="s2"><span class="s1"><strong>AJAX</strong><span class="s2"><strong>常见应用情景</strong></span></span></span></span></h2>
<p class="p1"><span class="s1">当我们在百度中输入一个<span class="s2">&ldquo;老<span class="s1"><span class="s2">&rdquo;<span class="s1">字后，会马上出现一个下拉列表！列表中显示的是包含<span class="s2">&ldquo;<span class="s1">传<span class="s2">&rdquo;<span class="s1">字的4<span class="s2"><span class="s1">个关键字。</span></span></span></span></span></span></span></span></span></span></span></p>
<p class="p1"><span class="s1">其实这里就使用了<span class="s2">AJAX<span class="s1">技术！当文件框发生了输入变化时，浏览器会使用<span class="s2">AJAX<span class="s1">技术向服务器发送一个请求，查询包含<span class="s2">&ldquo;<span class="s1">传<span class="s2">&rdquo;<span class="s1">字的前<span class="s2">10<span class="s1">个关键字，然后服务器会把查询到的结果响应给浏览器，最后浏览器把这4<span class="s2"><span class="s1">个关键字显示在下拉列表中。</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li class="li2"><span class="s3">整个过程中页面没有刷新，只是刷新页面中的局部位置而已！</span></li>
<li class="li2"><span class="s3">当请求发出后，浏览器还可以进行其他操作，无需等待服务器的响应！</span></li>
</ul>
<p><span class="s3">&nbsp; &nbsp; &nbsp; &nbsp;<img src="http://images2015.cnblogs.com/blog/877318/201610/877318-20161025165534625-1155566124.png" alt="" width="515" height="248" /></span></p>
<p>&nbsp;</p>
<p class="p1"><span class="s1">当输入用户名后，把光标移动到其他表单项上时，浏览器会使用<span class="s2">AJAX<span class="s1">技术向服务器发出请求，服务器会查询名为<span class="s2">zhangSan<span class="s1">的用户是否存在，最终服务器返回<span class="s2">true<span class="s1">表示名为lemontree7777777<span class="s2"><span class="s1">的用户已经存在了，浏览器在得到结果后显示<span class="s2">&ldquo;<span class="s1">用户名已被注册！<span class="s2">&rdquo;<span class="s1">。</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li class="li2"><span class="s3">整个过程中页面没有刷新，只是局部刷新了；</span></li>
<li class="li2"><span class="s3">在请求发出后，浏览器不用等待服务器响应结果就可以进行其他操作；</span></li>
</ul>
<h2 class="p1"><span class="s1"><span class="s2"><span class="s1"><strong>AJAX</strong><span class="s2"><strong>的优缺点</strong></span></span></span></span></h2>
<h4 class="p2"><span class="s1">优点：</span></h4>
<ul>
<li class="li2"><span class="s3"><span class="s4">AJAX<span class="s1">使用<span class="s4">Javascript<span class="s1">技术向服务器发送异步请求；</span></span></span></span></span></li>
<li class="li2"><span class="s3"><span class="s4">AJAX<span class="s1">无须刷新整个页面；</span></span></span></li>
<li class="li2"><span class="s3"><span class="s1">因为服务器响应内容不再是整个页面，而是页面中的局部，所以<span class="s4">AJAX<span class="s1">性能高；</span></span></span></span></li>
</ul>
<h1>jquery实现的ajax</h1>
<div class="cnblogs_code">
<pre>{% load staticfiles %<span style="color: #000000;">}

</span>&lt;!DOCTYPE html&gt;

&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;script src="{% static 'JS/jquery-3.1.1.js' %}"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;button class="send_Ajax"&gt;send_Ajax&lt;/button&gt;

&lt;script&gt;
      <span style="color: #008000;">//</span><span style="color: #008000;">$.ajax的两种使用方式:</span>

      <span style="color: #008000;">//</span><span style="color: #008000;">$.ajax(settings);</span>
      <span style="color: #008000;">//</span><span style="color: #008000;">$.ajax(url,[settings]);</span>
<span style="color: #000000;">

       $(</span>".send_Ajax").click(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){

           $.ajax({
               url:</span>"/handle_Ajax/"<span style="color: #000000;">,
               type:</span>"POST"<span style="color: #000000;">,
               data:{username:</span>"Yuan",password:123<span style="color: #000000;">},

               success:</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(data){
                   alert(data)
               },

                 </span><span style="color: #008000;">//</span><span style="color: #008000;">=================== error============</span>
<span style="color: #000000;">
                error: </span><span style="color: #0000ff;">function</span><span style="color: #000000;"> (jqXHR, textStatus, err) {

                        </span><span style="color: #008000;">//</span><span style="color: #008000;"> jqXHR: jQuery增强的xhr</span>
                        <span style="color: #008000;">//</span><span style="color: #008000;"> textStatus: 请求完成状态</span>
                        <span style="color: #008000;">//</span><span style="color: #008000;"> err: 底层通过throw抛出的异常对象，值与错误类型有关</span>
<span style="color: #000000;">                        console.log(arguments);
                    },

                 </span><span style="color: #008000;">//</span><span style="color: #008000;">=================== complete============</span>
<span style="color: #000000;">
                complete: </span><span style="color: #0000ff;">function</span><span style="color: #000000;"> (jqXHR, textStatus) {
                    </span><span style="color: #008000;">//</span><span style="color: #008000;"> jqXHR: jQuery增强的xhr</span>
                    <span style="color: #008000;">//</span><span style="color: #008000;"> textStatus: 请求完成状态 success | error</span>
                    console.log('statusCode: %d, statusText: %s'<span style="color: #000000;">, jqXHR.status, jqXHR.statusText);
                    console.log(</span>'textStatus: %s'<span style="color: #000000;">, textStatus);
                },

                </span><span style="color: #008000;">//</span><span style="color: #008000;">=================== statusCode============</span>
<span style="color: #000000;">                statusCode: {
                    </span>'403': <span style="color: #0000ff;">function</span><span style="color: #000000;"> (jqXHR, textStatus, err) {
                        console.log(arguments);  </span><span style="color: #008000;">//</span><span style="color: #008000;">注意：后端模拟errror方式：HttpResponse.status_code=500</span>
<span style="color: #000000;">                     },

                    </span>'400': <span style="color: #0000ff;">function</span><span style="color: #000000;"> () {
                    }
                }

           })

       })

</span>&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>
<h2><span>view：</span></h2>
<div class="cnblogs_Highlighter">
<pre class="brush:python;collapse:true;;gutter:true;">import json,time

def index(request):

    return render(request,"index.html")

def handle_Ajax(request):

    username=request.POST.get("username")
    password=request.POST.get("password")

    print(username,password)
    time.sleep(10)

    return HttpResponse(json.dumps("Error Data!"))
</pre>
</div>
<h2><span>$.ajax参数</span></h2>
<h3><span>请求参数</span></h3>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">#####################------------data---------################</span>
<span style="color: #000000;">
       data: 当前ajax请求要携带的数据，是一个json的object对象，ajax方法就会默认地把它编码成某种格式
             (urlencoded:?a</span>=1&amp;b=2<span style="color: #000000;">)发送给服务端；此外，ajax默认以get方式发送请求。

             function testData() {
               $.ajax(</span><span style="color: #800000;">"</span><span style="color: #800000;">/test</span><span style="color: #800000;">"</span>,{     //<span style="color: #000000;">此时的data是一个json形式的对象
                  data:{
                    a:</span>1<span style="color: #000000;">,
                    b:</span>2<span style="color: #000000;">
                  }
               });                   </span>//?a=1&amp;b=2
<span style="color: #008000;">#</span><span style="color: #008000;">#####################------------processData---------################</span>
<span style="color: #000000;">
processData：声明当前的data数据是否进行转码或预处理，默认为true，即预处理；if为false，
             那么对data：{a:</span>1,b:2}会调用json对象的toString()方法，即{a:1,b:2<span style="color: #000000;">}.toString()
             ,最后得到一个［object，Object］形式的结果。
            
</span><span style="color: #008000;">#</span><span style="color: #008000;">#####################------------contentType---------################</span>
<span style="color: #000000;">
contentType：默认值: </span><span style="color: #800000;">"</span><span style="color: #800000;">application/x-www-form-urlencoded</span><span style="color: #800000;">"</span><span style="color: #000000;">。发送信息至服务器时内容编码类型。
             用来指明当前请求的数据编码格式；urlencoded:?a</span>=1&amp;b=2<span style="color: #000000;">；如果想以其他方式提交数据，
             比如contentType:</span><span style="color: #800000;">"</span><span style="color: #800000;">application/json</span><span style="color: #800000;">"</span><span style="color: #000000;">，即向服务器发送一个json字符串：
               $.ajax(</span><span style="color: #800000;">"</span><span style="color: #800000;">/ajax_get</span><span style="color: #800000;">"</span><span style="color: #000000;">,{
             
                  data:JSON.stringify({
                       a:</span>22<span style="color: #000000;">,
                       b:</span>33<span style="color: #000000;">
                   }),
                   contentType:</span><span style="color: #800000;">"</span><span style="color: #800000;">application/json</span><span style="color: #800000;">"</span><span style="color: #000000;">,
                   type:</span><span style="color: #800000;">"</span><span style="color: #800000;">POST</span><span style="color: #800000;">"</span><span style="color: #000000;">,
             
               });                          </span>//{a: 22, b: 33<span style="color: #000000;">}

             注意：contentType:</span><span style="color: #800000;">"</span><span style="color: #800000;">application/json</span><span style="color: #800000;">"</span><span style="color: #000000;">一旦设定，data必须是json字符串，不能是json对象<br /><br />             <span style="color: #ff0000;">views.py:   json.loads(request.body.decode("utf8"))


</span></span><span style="color: #008000;">#</span><span style="color: #008000;">#####################------------traditional---------################</span>
<span style="color: #000000;">
traditional：一般是我们的data数据有数组时会用到 ：data:{a:</span>22,b:33,c:[<span style="color: #800000;">"</span><span style="color: #800000;">x</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">y</span><span style="color: #800000;">"</span><span style="color: #000000;">]},
              traditional为false会对数据进行深层次迭代；  </span></pre>
</div>
<h3>响应参数</h3>
<div class="cnblogs_code">
<pre><span style="color: #008000;">/*</span><span style="color: #008000;">

dataType：  预期服务器返回的数据类型,服务器端返回的数据会根据这个值解析后，传递给回调函数。
            默认不需要显性指定这个属性，ajax会根据服务器返回的content Type来进行转换；
            比如我们的服务器响应的content Type为json格式，这时ajax方法就会对响应的内容
            进行一个json格式的转换，if转换成功，我们在success的回调函数里就会得到一个json格式
            的对象；转换失败就会触发error这个回调函数。如果我们明确地指定目标类型，就可以使用
            data Type。
            dataType的可用值：html｜xml｜json｜text｜script
            见下dataType实例

</span><span style="color: #008000;">*/</span></pre>
</div>
<p>示例：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('75803138-0287-4f7a-ae7d-304f3b4ef3ea')"><img id="code_img_closed_75803138-0287-4f7a-ae7d-304f3b4ef3ea" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_75803138-0287-4f7a-ae7d-304f3b4ef3ea" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('75803138-0287-4f7a-ae7d-304f3b4ef3ea',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_75803138-0287-4f7a-ae7d-304f3b4ef3ea" class="cnblogs_code_hide">
<pre><span style="color: #000000;">from django.shortcuts import render,HttpResponse
from django.views.decorators.csrf import csrf_exempt
# Create your views here.

import json

def login(request):

    </span><span style="color: #0000ff;">return</span> render(request,'Ajax.html'<span style="color: #000000;">)


def ajax_get(request):

    l</span>=['alex','little alex'<span style="color: #000000;">]
    dic</span>={"name":"alex","pwd":123<span style="color: #000000;">}

    #</span><span style="color: #0000ff;">return</span><span style="color: #000000;"> HttpResponse(l)      #元素直接转成字符串alexlittle alex
    #</span><span style="color: #0000ff;">return</span><span style="color: #000000;"> HttpResponse(dic)    #字典的键直接转成字符串namepwd
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> HttpResponse(json.dumps(l))
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> HttpResponse(json.dumps(dic))# 传到前端的是json字符串,要想使用,需要JSON.parse(data)

</span><span style="color: #008000;">//</span><span style="color: #008000;">---------------------------------------------------</span>
    <span style="color: #0000ff;">function</span><span style="color: #000000;"> testData() {

        $.ajax(</span>'ajax_get'<span style="color: #000000;">, {
           success: </span><span style="color: #0000ff;">function</span><span style="color: #000000;"> (data) {
           console.log(data);
           console.log(</span><span style="color: #0000ff;">typeof</span><span style="color: #000000;">(data));
           </span><span style="color: #008000;">//</span><span style="color: #008000;">console.log(data.name);</span>
           <span style="color: #008000;">//</span><span style="color: #008000;">JSON.parse(data);</span>
           <span style="color: #008000;">//</span><span style="color: #008000;">console.log(data.name);</span>
<span style="color: #000000;">                                     },
           </span><span style="color: #008000;">//</span><span style="color: #008000;">dataType:"json",</span>
<span style="color: #000000;">                            }
                       )}

注解:Response Headers的content Type为text</span>/html,所以返回的是String;但如果我们想要一个json对象
    设定dataType:"json"<span style="color: #000000;">即可,相当于告诉ajax方法把服务器返回的数据转成json对象发送到前端.结果为object
    当然，
        </span><span style="color: #0000ff;">return</span> HttpResponse(json.dumps(a),content_type="application/json"<span style="color: #000000;">)

    这样就不需要设定dataType:</span>"json"<span style="color: #000000;">了。
    content_type</span>="application/json"和content_type="json"是一样的！</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<h2>csrf跨站请求伪造</h2>
<h3>方式1</h3>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">$.ajaxSetup({
    data: {csrfmiddlewaretoken: '{{ csrf_token }}' },
});</pre>
</div>
<h3>方式2</h3>
<div class="cnblogs_Highlighter">
<pre class="brush:html;gutter:true;">&lt;form&gt;
{% csrf_token %}
&lt;/form&gt;<br /><br /><br />$.ajax({<br />...<br />data:{</pre>
<pre>"csrfmiddlewaretoken":$("[name='csrfmiddlewaretoken']").val();</pre>
<pre class="brush:html;gutter:true;">}<br />})</pre>
</div>
<h3>方式3：</h3>
<div class="cnblogs_Highlighter">
<pre class="brush:html;gutter:true;">&lt;script src="{% static 'js/jquery.cookie.js' %}"&gt;&lt;/script&gt;
</pre>
</div>
<div class="cnblogs_Highlighter">
<pre class="brush:html;gutter:true;">$.ajax({

headers:{"X-CSRFToken":$.cookie('csrftoken')},

})
</pre>
</div>
<h1>JS实现的ajax</h1>
<h2 class="p1"><span class="s1"><strong>AJAX</strong><span class="s2"><strong>核心（</strong><span class="s1"><strong>XMLHttpRequest</strong><span class="s2"><strong>）</strong></span></span></span></span></h2>
<p class="p2"><span class="s1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 其实<span class="s3">AJAX<span class="s1">就是在<span class="s3">Javascript<span class="s1">中多添加了一个对象：<span class="s3">XMLHttpRequest<span class="s1">对象。所有的异步交互都是使用<span class="s3">XMLHttpServlet<span class="s1">对象完成的。也就是说，我们只需要学习一个<span class="s3">Javascript<span class="s1">的新对象即可。</span></span></span></span></span></span></span></span></span></span></span></p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var xmlHttp = new XMLHttpRequest()；（大多数浏览器都支持DOM2规范）
</pre>
</div>
<p><span class="s4">注意，各个浏览器对<span class="s5">XMLHttpRequest<span class="s4">的支持也是不同的！<span class="s1">为了处理浏览器兼容问题，给出下面方法来创建<span class="s3">XMLHttpRequest<span class="s1">对象：</span></span></span></span></span></span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('74e79927-b8d4-44bb-b3cb-0011fed1f3b2')"><img id="code_img_closed_74e79927-b8d4-44bb-b3cb-0011fed1f3b2" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_74e79927-b8d4-44bb-b3cb-0011fed1f3b2" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('74e79927-b8d4-44bb-b3cb-0011fed1f3b2',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_74e79927-b8d4-44bb-b3cb-0011fed1f3b2" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">function</span><span style="color: #000000;"> createXMLHttpRequest() {
        </span><span style="color: #0000ff;">var</span><span style="color: #000000;"> xmlHttp;
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> 适用于大多数浏览器，以及IE7和IE更高版本</span>
        <span style="color: #0000ff;">try</span><span style="color: #000000;">{
            xmlHttp </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> XMLHttpRequest();
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (e) {
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> 适用于IE6</span>
            <span style="color: #0000ff;">try</span><span style="color: #000000;"> {
                xmlHttp </span>= <span style="color: #0000ff;">new</span> ActiveXObject("Msxml2.XMLHTTP"<span style="color: #000000;">);
            } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (e) {
                </span><span style="color: #008000;">//</span><span style="color: #008000;"> 适用于IE5.5，以及IE更早版本</span>
                <span style="color: #0000ff;">try</span><span style="color: #000000;">{
                    xmlHttp </span>= <span style="color: #0000ff;">new</span> ActiveXObject("Microsoft.XMLHTTP"<span style="color: #000000;">);
                } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (e){}
            }
        }            
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> xmlHttp;
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<h2>使用流程</h2>
<h3 class="p1"><span class="s1"><span class="s2"><strong>步骤1: &nbsp;打开与服务器的连接（</strong><span class="s1"><strong>open</strong><span class="s2"><strong>方法）</strong></span></span></span></span></h3>
<p class="p2"><span class="s2">当得到<span class="s3">XMLHttpRequest<span class="s2">对象后，就可以调用该对象的<span class="s3">open()<span class="s2">方法打开与服务器的连接了。<span class="s3">open()<span class="s2">方法的参数如下：</span></span></span></span></span></span></span></p>
<p class="p3"><span class="s2">open(method, url, async)<span class="s4">：</span></span></p>
<ul>
<li class="li4"><span class="s5"><span class="s2">method<span class="s4">：请求方式，通常为<span class="s2">GET<span class="s4">或<span class="s2">POST<span class="s4">；</span></span></span></span></span></span></span></li>
<li class="li5"><span class="s5"><span class="s3">url<span class="s2">：请求的服务器地址，例如：<span class="s3">/ajaxdemo1/AServlet<span class="s2">，若为<span class="s3">GET<span class="s2">请求，还可以在<span class="s3">URL<span class="s2">后追加参数；</span></span></span></span></span></span></span></span></span></li>
<li class="li5"><span class="s5"><span class="s3">async<span class="s2">：这个参数可以不给，默认值为<span class="s3">true<span class="s2">，表示异步请求；</span></span></span></span></span></li>
</ul>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var xmlHttp = createXMLHttpRequest();
xmlHttp.open("GET", "/ajax_get/?a=1", true);　</pre>
</div>
<h3 class="p1"><span class="s1"><span class="s2"><strong>步骤2: &nbsp;发送请求</strong></span></span></h3>
<p class="p2"><span class="s2">当使用<span class="s3">open<span class="s2">打开连接后，就可以调用<span class="s3">XMLHttpRequest<span class="s2">对象的<span class="s3">send()<span class="s2">方法发送请求了。<span class="s3">send()<span class="s2">方法的参数为<span class="s3">POST<span class="s2">请求参数，即对应<span class="s3">HTTP<span class="s2">协议的请求体内容，若是<span class="s3">GET<span class="s2">请求，需要在<span class="s3">URL<span class="s2">后连接参数。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p class="p2"><span class="s2">注意：若没有参数，需要给出<span class="s3">null<span class="s2">为参数！若不给出<span class="s3">null<span class="s2">为参数，可能会导致<span class="s3">FireFox<span class="s2">浏览器不能正常发送请求！</span></span></span></span></span></span></span></p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">xmlHttp.send(null);</pre>
</div>
<h3 class="p1"><span class="s1">步骤3: &nbsp;接收服务器响应</span></h3>
<p class="p2"><span class="s2">当请求发送出去后，服务器端<span class="s3"><span class="s2">就开始执行了，但服务器端的响应还没有接收到。接下来我们来接收服务器的响应。</span></span></span></p>
<p class="p3"><span class="s2">XMLHttpRequest<span class="s4">对象有一个<span class="s2">onreadystatechange<span class="s4">事件，它会在<span class="s2">XMLHttpRequest<span class="s4">对象的状态发生变化时被调用。下面介绍一下<span class="s2">XMLHttpRequest<span class="s4">对象的<span class="s2">5<span class="s4">种状态：</span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li class="li4"><span class="s5"><span class="s3">0<span class="s2">：初始化未完成状态，只是创建了<span class="s3">XMLHttpRequest<span class="s2">对象，还未调用<span class="s3">open()<span class="s2">方法；</span></span></span></span></span></span></span></li>
<li class="li4"><span class="s5"><span class="s3">1<span class="s2">：请求已开始，<span class="s3">open()<span class="s2">方法已调用，但还没调用<span class="s3">send()<span class="s2">方法；</span></span></span></span></span></span></span></li>
<li class="li4"><span class="s5"><span class="s3">2<span class="s2">：请求发送完成状态，<span class="s3">send()<span class="s2">方法已调用；</span></span></span></span></span></li>
<li class="li4"><span class="s5"><span class="s3">3<span class="s2">：开始读取服务器响应；</span></span></span></li>
<li class="li4"><span class="s5"><span class="s3">4<span class="s2">：读取服务器响应结束。<span class="s2">&nbsp;</span></span></span></span></li>
</ul>
<p class="p6"><span class="s2">onreadystatechange<span class="s4">事件会在状态为<span class="s2">1<span class="s4">、<span class="s2">2<span class="s4">、<span class="s2">3<span class="s4">、<span class="s2">4<span class="s4">时引发。</span></span></span></span></span></span></span></span></span></span></p>
<p class="p4"><span class="s2">　　下面代码会被执行四次！对应<span class="s3">XMLHttpRequest<span class="s2">的四种状态！</span></span></span></p>
<div class="cnblogs_code">
<pre>xmlHttp.onreadystatechange = <span style="color: #0000ff;">function</span><span style="color: #000000;">() {
            alert(</span>'hello'<span style="color: #000000;">);
        };</span></pre>
</div>
<p>但通常我们只关心最后一种状态，即读取服务器响应结束时，客户端才会做出改变。我们可以通过<span class="s2">XMLHttpRequest<span class="s1">对象的<span class="s2">readyState<span class="s1">属性来得到<span class="s2">XMLHttpRequest<span class="s1">对象的状态。</span></span></span></span></span></span></p>
<div class="cnblogs_code">
<pre>xmlHttp.onreadystatechange = <span style="color: #0000ff;">function</span><span style="color: #000000;">() {
            </span><span style="color: #0000ff;">if</span>(xmlHttp.readyState == 4<span style="color: #000000;">) {
                alert(</span>'hello'<span style="color: #000000;">);    
            }
        };</span></pre>
</div>
<p class="p1"><span class="s1">其实我们还要关心服务器响应的状态码是否为<span class="s2">200<span class="s1">，其服务器响应为<span class="s2">404<span class="s1">，或<span class="s2">500<span class="s1">，那么就表示请求失败了。我们可以通过<span class="s2">XMLHttpRequest<span class="s1">对象的<span class="s2">status<span class="s1">属性得到服务器的状态码。</span></span></span></span></span></span></span></span></span></span></span></p>
<p class="p2"><span class="s1">最后，我们还需要获取到服务器响应的内容，可以通过<span class="s2">XMLHttpRequest<span class="s1">对象的<span class="s2">responseText<span class="s1">得到服务器响应内容。</span></span></span></span></span></p>
<div class="cnblogs_code">
<pre>xmlHttp.onreadystatechange = <span style="color: #0000ff;">function</span><span style="color: #000000;">() {
            </span><span style="color: #0000ff;">if</span>(xmlHttp.readyState == 4 &amp;&amp; xmlHttp.status == 200<span style="color: #000000;">) {
                alert(xmlHttp.responseText);    
            }
        };</span></pre>
</div>
<h2 class="p1"><span class="s1">&nbsp;if 发送<span class="s2">POST<span class="s1">请求</span></span></span></h2>
<p class="li1"><span class="s3"><span class="s1">&lt;1&gt;需要设置请求头：<span class="s2"><span class="s1"><span class="s3"><span class="s1"><span class="s2">xmlHttp.<span class="s2">setRequestHeader(&ldquo;Content-Type&rdquo;, &ldquo;application/x-www-form-urlencoded&rdquo;)<span class="s1">；</span></span></span></span></span></span></span></span></span><span class="s3"><span class="s1"><span class="s2"><span class="s1"><span class="s2"><span class="s1">注意 :form表单会默认这个键值对不设定，<span class="s1"><span class="s2"><span class="s1"><span class="s2"><span class="s1"><span class="s2">Web<span class="s1">服务器会忽略请求体的内容。</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p class="li1"><span class="s3"><span class="s1">&lt;2&gt;在发送时可以指定请求体了：<span class="s2">xmlHttp.send(&ldquo;username=yuan<span class="s1"><span class="s2">&amp;password=123&rdquo;)</span></span></span></span></span></p>
<h2 class="p1">JS实现ajax小结</h2>
<div class="cnblogs_code">
<pre><span style="color: #008000;">/*</span><span style="color: #008000;">
    创建XMLHttpRequest对象；
    调用open()方法打开与服务器的连接；
    调用send()方法发送请求；
    为XMLHttpRequest对象指定onreadystatechange事件函数，这个函数会在

    XMLHttpRequest的1、2、3、4，四种状态时被调用；

    XMLHttpRequest对象的5种状态，通常我们只关心4状态。

    XMLHttpRequest对象的status属性表示服务器状态码，它只有在readyState为4时才能获取到。

    XMLHttpRequest对象的responseText属性表示服务器响应内容，它只有在
    readyState为4时才能获取到！

</span><span style="color: #008000;">*/</span></pre>
</div>
<p>测试代码：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('ebb5b354-6bb7-457a-b969-57ff42556a72')"><img id="code_img_closed_ebb5b354-6bb7-457a-b969-57ff42556a72" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_ebb5b354-6bb7-457a-b969-57ff42556a72" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('ebb5b354-6bb7-457a-b969-57ff42556a72',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_ebb5b354-6bb7-457a-b969-57ff42556a72" class="cnblogs_code_hide">
<pre>&lt;h1&gt;AJAX&lt;/h1&gt;
&lt;button onclick="send()"&gt;测试&lt;/button&gt;
&lt;div id="div1"&gt;&lt;/div&gt;


&lt;script&gt;
       <span style="color: #0000ff;">function</span><span style="color: #000000;"> createXMLHttpRequest() {
            </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
                </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> XMLHttpRequest();<span style="color: #008000;">//</span><span style="color: #008000;">大多数浏览器</span>
            } <span style="color: #0000ff;">catch</span><span style="color: #000000;"> (e) {
                </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
                    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> ActiveXObject("Msxml2.XMLHTTP"<span style="color: #000000;">);
                } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (e) {
                    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> ActiveXObject("Microsoft.XMLHTTP"<span style="color: #000000;">);
                }
            }
        }

        </span><span style="color: #0000ff;">function</span><span style="color: #000000;"> send() {
            </span><span style="color: #0000ff;">var</span> xmlHttp =<span style="color: #000000;"> createXMLHttpRequest();
            xmlHttp.onreadystatechange </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">() {
                </span><span style="color: #0000ff;">if</span>(xmlHttp.readyState == 4 &amp;&amp; xmlHttp.status == 200<span style="color: #000000;">) {
                    </span><span style="color: #0000ff;">var</span> div = document.getElementById("div1"<span style="color: #000000;">);
                    div.innerText </span>=<span style="color: #000000;"> xmlHttp.responseText;
                    div.textContent </span>=<span style="color: #000000;"> xmlHttp.responseText;
                }
            };

            xmlHttp.open(</span>"POST", "/ajax_post/", <span style="color: #0000ff;">true</span><span style="color: #000000;">);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">post: xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");</span>
            xmlHttp.send(<span style="color: #0000ff;">null</span>);  <span style="color: #008000;">//</span><span style="color: #008000;">post: xmlHttp.send("b=B");</span>
<span style="color: #000000;">        }


</span>&lt;/script&gt;
<span style="color: #000000;">       
#</span>--------------------------------<span style="color: #000000;">views.py 
from django.views.decorators.csrf import csrf_exempt

def login(request):
    print(</span>'hello ajax'<span style="color: #000000;">)
    </span><span style="color: #0000ff;">return</span> render(request,'index.html'<span style="color: #000000;">)

@csrf_exempt   ＃csrf防御
def ajax_post(request):
    print(</span>'ok'<span style="color: #000000;">)
    </span><span style="color: #0000ff;">return</span> HttpResponse('helloyuanhao') </pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<h2 class="p1">实例（用户名是否已被注册）</h2>
<h3 class="p2"><span class="s3"><strong>7.1</strong><span class="s2"><strong>　功能介绍</strong></span></span></h3>
<p class="p3"><span class="s2">在注册表单中，当用户填写了用户名后，把光标移开后，会自动向服务器发送异步请求。服务器返回<span class="s4">true<span class="s2">或<span class="s4">false<span class="s2">，返回<span class="s4">true<span class="s2">表示这个用户名已经被注册过，返回<span class="s4">false<span class="s2">表示没有注册过。</span></span></span></span></span></span></span></span></span></p>
<p class="p3"><span class="s2">客户端得到服务器返回的结果后，确定是否在用户名文本框后显示<span class="s4">&ldquo;<span class="s2">用户名已被注册<span class="s4">&rdquo;<span class="s2">的错误信息！</span></span></span></span></span></p>
<h3 class="p2"><span class="s3"><strong>7.2</strong><span class="s2"><strong>　案例分析</strong></span></span></h3>
<ul>
<li class="li5"><span class="s5">页面中给出注册表单；</span></li>
<li class="li5"><span class="s5"><span class="s6">在<span class="s2">username<span class="s6">表单字段中添加<span class="s2">onblur<span class="s6">事件，调用<span class="s2">send()<span class="s6">方法；</span></span></span></span></span></span></span></span></li>
<li class="li6"><span class="s5"><span class="s4">send()<span class="s2">方法获取<span class="s4">username<span class="s2">表单字段的内容，向服务器发送异步请求，参数为<span class="s4">username<span class="s2">；</span></span></span></span></span></span></span></li>
<li class="li5"><span class="s5"><span class="s2">django 的视图函数<span class="s6">：获取<span class="s2">username<span class="s6">参数，判断是否为<span class="s2">&ldquo;yuan&rdquo;<span class="s6">，如果是响应<span class="s2">true<span class="s6">，否则响应<span class="s2">false</span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p><span class="s5"><span class="s2"><span class="s6"><span class="s2"><span class="s6"><span class="s2"><span class="s6"><span class="s2"><span class="s6"><span class="s2">参考代码：</span></span></span></span></span></span></span></span></span></span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('8a0cf543-2f0b-4385-9c30-1e2b67d00d7f')"><img id="code_img_closed_8a0cf543-2f0b-4385-9c30-1e2b67d00d7f" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_8a0cf543-2f0b-4385-9c30-1e2b67d00d7f" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('8a0cf543-2f0b-4385-9c30-1e2b67d00d7f',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_8a0cf543-2f0b-4385-9c30-1e2b67d00d7f" class="cnblogs_code_hide">
<pre>&lt;script type="text/javascript"&gt;
        <span style="color: #0000ff;">function</span><span style="color: #000000;"> createXMLHttpRequest() {
            </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
                </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> XMLHttpRequest();
            } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (e) {
                </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
                    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> ActiveXObject("Msxml2.XMLHTTP"<span style="color: #000000;">);
                } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (e) {
                    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> ActiveXObject("Microsoft.XMLHTTP"<span style="color: #000000;">);
                }
            }
        }

        </span><span style="color: #0000ff;">function</span><span style="color: #000000;"> send() {
            </span><span style="color: #0000ff;">var</span> xmlHttp =<span style="color: #000000;"> createXMLHttpRequest();
            xmlHttp.onreadystatechange </span>= <span style="color: #0000ff;">function</span><span style="color: #000000;">() {
                </span><span style="color: #0000ff;">if</span>(xmlHttp.readyState == 4 &amp;&amp; xmlHttp.status == 200<span style="color: #000000;">) {
                    </span><span style="color: #0000ff;">if</span>(xmlHttp.responseText == "true"<span style="color: #000000;">) {
                        document.getElementById(</span>"error").innerText = "用户名已被注册！"<span style="color: #000000;">;
                        document.getElementById(</span>"error").textContent = "用户名已被注册！"<span style="color: #000000;">;
                    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                        document.getElementById(</span>"error").innerText = ""<span style="color: #000000;">;
                        document.getElementById(</span>"error").textContent = ""<span style="color: #000000;">;
                    }
                }
            };
            xmlHttp.open(</span>"POST", "/ajax_check/", <span style="color: #0000ff;">true</span>, "json"<span style="color: #000000;">);
            xmlHttp.setRequestHeader(</span>"Content-Type", "application/x-www-form-urlencoded"<span style="color: #000000;">);
            </span><span style="color: #0000ff;">var</span> username = document.getElementById("username"<span style="color: #000000;">).value;
            xmlHttp.send(</span>"username=" +<span style="color: #000000;"> username);
        }
</span>&lt;/script&gt;

<span style="color: #008000;">//</span><span style="color: #008000;">--------------------------------------------------index.html</span>

&lt;h1&gt;注册&lt;/h1&gt;
&lt;form action="" method="post"&gt;<span style="color: #000000;">
用户名：</span>&lt;input id="username" type="text" name="username" onblur="send()"/&gt;&lt;span id="error"&gt;&lt;/span&gt;&lt;br/&gt;
密　码：&lt;input type="text" name="password"/&gt;&lt;br/&gt;
&lt;input type="submit" value="注册"/&gt;
&lt;/form&gt;


<span style="color: #008000;">//</span><span style="color: #008000;">--------------------------------------------------views.py</span>
<span style="color: #000000;">from django.views.decorators.csrf import csrf_exempt

def login(request):
    print(</span>'hello ajax'<span style="color: #000000;">)
    </span><span style="color: #0000ff;">return</span> render(request,'index.html'<span style="color: #000000;">)
    # </span><span style="color: #0000ff;">return</span> HttpResponse('helloyuanhao'<span style="color: #000000;">)

@csrf_exempt
def ajax_check(request):
    print(</span>'ok'<span style="color: #000000;">)

    username</span>=request.POST.get('username'<span style="color: #000000;">,None)
    </span><span style="color: #0000ff;">if</span> username=='yuan'<span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> HttpResponse('true'<span style="color: #000000;">)
    </span><span style="color: #0000ff;">return</span> HttpResponse('false')</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<h1 class="entry-title">jQuery.serialize()</h1>
<p><code>serialize()</code>函数用于<strong>序列化一组表单元素，将表单内容编码为用于提交的字符串</strong>。</p>
<p><code>serialize()</code>函数常用于将表单内容序列化，以便用于AJAX提交。</p>
<p>该函数主要根据<strong>用于提交</strong>的<strong>有效</strong>表单控件的name和value，将它们拼接为一个可直接用于表单提交的文本字符串，该字符串已经过标准的URL编码处理(字符集编码为UTF-8)。</p>
<p>该函数不会序列化不需要提交的表单控件，这和常规的表单提交行为是一致的。例如：不在&lt;form&gt;标签内的表单控件不会被提交、没有name属性的表单控件不会被提交、带有disabled属性的表单控件不会被提交、没有被选中的表单控件不会被提交。</p>
<div class="cnblogs_code">
<pre>与常规表单提交不一样的是：常规表单一般会提交带有name的按钮控件，而serialize()函数不会序列化带有name的按钮控件。更多详情请点击这里。</pre>
</div>
<h3>语法</h3>
<p>jQuery <span class="notice">1.0 新增该函数。</span></p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">jQueryObject.serialize( )
</pre>
</div>
<h3>返回值</h3>
<p><code>serialize()</code>函数的返回值为<span class="notice">String类型，返回将表单元素编码后的可用于表单提交的文本字符串。</span></p>
<p><span class="notice">请参考下面这段初始HTML代码：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">form </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="myForm"</span><span style="color: #ff0000;"> action</span><span style="color: #0000ff;">="http://www.365mini.com"</span><span style="color: #ff0000;"> method</span><span style="color: #0000ff;">="post"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="uid"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="hidden"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="1"</span> <span style="color: #0000ff;">/&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="username"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="张三"</span> <span style="color: #0000ff;">/&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="password"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="123456"</span> <span style="color: #0000ff;">/&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">select </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="grade"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="grade"</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">option </span><span style="color: #ff0000;">value</span><span style="color: #0000ff;">="1"</span><span style="color: #0000ff;">&gt;</span>一年级<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">option</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">option </span><span style="color: #ff0000;">value</span><span style="color: #0000ff;">="2"</span><span style="color: #0000ff;">&gt;</span>二年级<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">option</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">option </span><span style="color: #ff0000;">value</span><span style="color: #0000ff;">="3"</span><span style="color: #ff0000;"> selected</span><span style="color: #0000ff;">="selected"</span><span style="color: #0000ff;">&gt;</span>三年级<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">option</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">option </span><span style="color: #ff0000;">value</span><span style="color: #0000ff;">="4"</span><span style="color: #0000ff;">&gt;</span>四年级<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">option</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">option </span><span style="color: #ff0000;">value</span><span style="color: #0000ff;">="5"</span><span style="color: #0000ff;">&gt;</span>五年级<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">option</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">option </span><span style="color: #ff0000;">value</span><span style="color: #0000ff;">="6"</span><span style="color: #0000ff;">&gt;</span>六年级<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">option</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">select</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="sex"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="radio"</span><span style="color: #ff0000;"> checked</span><span style="color: #0000ff;">="checked"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="1"</span> <span style="color: #0000ff;">/&gt;</span><span style="color: #000000;">男
    </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="sex"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="radio"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="0"</span> <span style="color: #0000ff;">/&gt;</span><span style="color: #000000;">女
    </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="hobby"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="checkbox"</span><span style="color: #ff0000;"> checked</span><span style="color: #0000ff;">="checked"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="1"</span> <span style="color: #0000ff;">/&gt;</span><span style="color: #000000;">游泳
    </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="hobby"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="checkbox"</span><span style="color: #ff0000;"> checked</span><span style="color: #0000ff;">="checked"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="2"</span> <span style="color: #0000ff;">/&gt;</span><span style="color: #000000;">跑步
    </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="hobby"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="checkbox"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="3"</span> <span style="color: #0000ff;">/&gt;</span><span style="color: #000000;">羽毛球
    </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="btn"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="btn"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="button"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="点击"</span> <span style="color: #0000ff;">/&gt;</span></pre>
</div>
<p>对&lt;form&gt;元素进行序列化可以直接序列化其内部的所有表单元素。</p>
<div class="cnblogs_code">
<pre>// 序列化<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">form</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">内的所有表单元素
// 序列化后的结果：uid=1</span><span style="color: #ff0000;">&amp;username</span>=%E5%BC%A0%E4%B8%89<span style="color: #ff0000;">&amp;password</span>=123456<span style="color: #ff0000;">&amp;grade</span>=3<span style="color: #ff0000;">&amp;sex</span>=1<span style="color: #ff0000;">&amp;hobby</span>=1<span style="color: #ff0000;">&amp;hobby</span><span style="color: #000000;">=2
alert( $("form").serialize() );</span></pre>
</div>
<p>我们也可以直接对部分表单元素进行序列化。</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">// 序列化所有的text、select、checkbox表单元素
// 序列化后的结果：username=%E5%BC%A0%E4%B8%89</span><span style="color: #ff0000;">&amp;password</span>=123456<span style="color: #ff0000;">&amp;grade</span>=3<span style="color: #ff0000;">&amp;hobby</span>=1<span style="color: #ff0000;">&amp;hobby</span><span style="color: #000000;">=2
alert( $(":text, select, :checkbox").serialize() );</span></pre>
</div>
<p><code>serialize()</code>函数通常用于将表单内容序列化，以便通过AJAX方式提交。</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">$("#btn").click( function(){

    // 将当前表单内容以POST请求的AJAX方式提交到"http://www.365mini.com"
    $.post( "http://www.365mini.com", $("form").serialize(), function( data, textStatus, jqXHR ){
        alert( "AJAX提交成功!" );       
    } );
        
} );</span></pre>
</div>
<h1>上传文件</h1>
<h2>form表单上传文件</h2>
<h3>html</h3>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">h3</span><span style="color: #0000ff;">&gt;</span>form表单上传文件<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">h3</span><span style="color: #0000ff;">&gt;</span>


<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">form </span><span style="color: #ff0000;">action</span><span style="color: #0000ff;">="/upload_file/"</span><span style="color: #ff0000;"> method</span><span style="color: #0000ff;">="post"</span><span style="color: #ff0000;"> enctype</span><span style="color: #0000ff;">="multipart/form-data"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="file"</span><span style="color: #ff0000;"> name</span><span style="color: #0000ff;">="upload_file_form"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="submit"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">form</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<h3>view</h3>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">def</span><span style="color: #000000;"> index(request):

    </span><span style="color: #0000ff;">return</span> render(request,<span style="color: #800000;">"</span><span style="color: #800000;">index.html</span><span style="color: #800000;">"</span><span style="color: #000000;">)


</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> upload_file(request):
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">FILES:</span><span style="color: #800000;">"</span><span style="color: #000000;">,request.FILES)
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">POST:</span><span style="color: #800000;">"</span><span style="color: #000000;">,request.POST)
    </span><span style="color: #0000ff;">return</span> HttpResponse(<span style="color: #800000;">"</span><span style="color: #800000;">上传成功!</span><span style="color: #800000;">"</span>)</pre>
</div>
<h2>Ajax(FormData)</h2>
<p><span style="font-family: Microsoft YaHei;">FormData是什么呢？</span></p>
<p>&nbsp;</p>
<div>XMLHttpRequest Level 2添加了一个新的接口<code>FormData</code>.利用<code>FormData对象</code>,我们可以通过JavaScript用一些键值对来模拟一系列表单控件,我们还可以使用XMLHttpRequest的<code>send()</code>方法来异步的提交这个"表单".比起普通的ajax,使用<code>FormData</code>的最大优点就是我们可以异步上传一个二进制文件.</div>
<div><span style="font-family: Microsoft YaHei;"><span style="font-family: Microsoft YaHei;">所有主流浏览器的较新版本都已经支持这个对象了，比如Chrome 7+、Firefox 4+、IE 10+、Opera 12+、Safari 5+。</span></span></div>
<h3><strong>html</strong></h3>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">h3</span><span style="color: #0000ff;">&gt;</span>Ajax上传文件<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">h3</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> name</span><span style="color: #0000ff;">="username"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="username"</span><span style="color: #ff0000;"> placeholder</span><span style="color: #0000ff;">="username"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="file"</span><span style="color: #ff0000;"> name</span><span style="color: #0000ff;">="upload_file_ajax"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="upload_file_ajax"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">button </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="upload_button"</span><span style="color: #0000ff;">&gt;</span>提交<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">button</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
{#注意button标签不要用在form表单中使用#}

</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">
    $(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">#upload_button</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).click(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){<br />
        </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> username</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">$(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">#username</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).val();
        </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> upload_file</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">$(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">#upload_file_ajax</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">)[</span><span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">].files[</span><span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">];

        </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> formData</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #0000ff;">new</span><span style="background-color: #f5f5f5; color: #000000;"> FormData();
        formData.append(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">username</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,username);
        formData.append(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">upload_file_ajax</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,upload_file);


        $.ajax({
            url:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">/upload_file/</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,
            type:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">POST</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,
            data:formData,
            contentType:</span><span style="background-color: #f5f5f5; color: #0000ff;">false</span><span style="background-color: #f5f5f5; color: #000000;">,
            processData:</span><span style="background-color: #f5f5f5; color: #0000ff;">false</span><span style="background-color: #f5f5f5; color: #000000;">,

            success:</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){
                alert(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">上传成功!</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">)
            }
        });


    })
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<h3>views</h3>
<div class="cnblogs_Highlighter">
<pre class="brush:python;collapse:true;;gutter:true;">def index(request):
 
    return render(request,"index.html")
 
 
def upload_file(request):
    print("FILES:",request.FILES)
    print("POST:",request.POST)
    return HttpResponse("上传成功!")
</pre>
</div>
<h2>伪造Ajax上传文件</h2>
<h3>iframe标签</h3>
<p>&lt;iframe&gt; 标签规定一个内联框架。</p>
<p>一个内联框架被用来在当前 HTML 文档中嵌入另一个文档。</p>
<p>示例：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:html;gutter:true;">&lt;iframe src="http://www.baidu.com" width="1000px" height="600px"&gt;&lt;/iframe&gt;
</pre>
</div>
<h3>iframe+form</h3>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">h3</span><span style="color: #0000ff;">&gt;</span>伪造Ajax上传文件<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">h3</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">form </span><span style="color: #ff0000;">action</span><span style="color: #0000ff;">="/upload_file/"</span><span style="color: #ff0000;"> method</span><span style="color: #0000ff;">="post"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="form2"</span><span style="color: #ff0000;"> target</span><span style="color: #0000ff;">="ifr"</span><span style="color: #ff0000;"> enctype</span><span style="color: #0000ff;">="multipart/form-data"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">iframe </span><span style="color: #ff0000;">name</span><span style="color: #0000ff;">="ifr"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="ifr"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">iframe</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="file"</span><span style="color: #ff0000;"> name</span><span style="color: #0000ff;">="upload_file"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> name</span><span style="color: #0000ff;">="user"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="button"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="提交"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="submitBtn"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">form</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">



    $(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">#submitBtn</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).click(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){

        $(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">#ifr</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).load(iframeLoaded);
        $(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">#form2</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).submit();


    });

    </span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> iframeLoaded(){
        alert(</span><span style="background-color: #f5f5f5; color: #000000;">123</span><span style="background-color: #f5f5f5; color: #000000;">)
    }

</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p><strong>views</strong></p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;collapse:true;;gutter:true;">def index(request):

    return render(request,"index.html")

def upload_file(request):
    print("FILES:",request.FILES)
    print("POST:",request.POST)
    return HttpResponse("上传成功!")
</pre>
</div>
<h1>同源策略与Jsonp</h1>
<h2>同源策略</h2>
<p>同源策略（Same origin policy）是一种约定，它是浏览器最核心也最基本的安全功能，如果缺少了同源策略，则浏览器的正常功能可能都会受到影响。可以说Web是构建在同源策略基础之上的，浏览器只是针对同源策略的一种实现。</p>
<div class="para">同源策略，它是由Netscape提出的一个著名的安全策略。现在所有支持JavaScript 的浏览器都会使用这个策略。所谓同源是指，域名，协议，端口相同。当一个浏览器的两个tab页中分别打开来 百度和谷歌的页面当浏览器的百度tab页执行一个脚本的时候会检查这个脚本是属于哪个页面的，即检查是否同源，只有和百度同源的脚本才会被执行。<a class="sup-anchor" name="ref_[1]_3747010"></a>如果非同源，那么在请求数据时，浏览器会在控制台中报一个异常，提示拒绝访问。</div>
<div class="para">&nbsp;</div>
<h3 class="para">示例：</h3>
<div class="para"><strong>项目1:</strong></div>
<div class="para">
<div class="cnblogs_code" onclick="cnblogs_code_show('40c3fd0b-5b54-40c9-92f1-79416017b115')"><img id="code_img_closed_40c3fd0b-5b54-40c9-92f1-79416017b115" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_40c3fd0b-5b54-40c9-92f1-79416017b115" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('40c3fd0b-5b54-40c9-92f1-79416017b115',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_40c3fd0b-5b54-40c9-92f1-79416017b115" class="cnblogs_code_hide">
<pre><span style="color: #000000;">==================================http://127.0.0.1:8001项目的index
</span><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html </span><span style="color: #ff0000;">lang</span><span style="color: #0000ff;">="en"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">meta </span><span style="color: #ff0000;">charset</span><span style="color: #0000ff;">="UTF-8"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>Title<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">src</span><span style="color: #0000ff;">="http://code.jquery.com/jquery-latest.js"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>


<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">button</span><span style="color: #0000ff;">&gt;</span>ajax<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">button</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
{% csrf_token %}

</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">
    $(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">button</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).click(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){


        $.ajax({
            url:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">http://127.0.0.1:7766/SendAjax/</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,
            type:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">POST</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,
            data:{</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">username</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">yuan</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">csrfmiddlewaretoken</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">:$(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">[name='csrfmiddlewaretoken']</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).val()},
            success:</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(data){
                alert(</span><span style="background-color: #f5f5f5; color: #000000;">123</span><span style="background-color: #f5f5f5; color: #000000;">);
                alert(data)
            }
        })
    })
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


==================================http://127.0.0.1:8001项目的views

def index(request):


    return render(request,"index.html")


def ajax(request):
    import json
    print(request.POST,"+++++++++++")
    return HttpResponse(json.dumps("hello"))</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
</div>
<div class="para">
<p><strong>项目2:</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('de23ec75-62ba-4c08-9749-9f978cfbbffb')"><img id="code_img_closed_de23ec75-62ba-4c08-9749-9f978cfbbffb" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_de23ec75-62ba-4c08-9749-9f978cfbbffb" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('de23ec75-62ba-4c08-9749-9f978cfbbffb',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_de23ec75-62ba-4c08-9749-9f978cfbbffb" class="cnblogs_code_hide">
<pre><span style="color: #000000;">==================================http://127.0.0.1:8002项目的index
</span><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html </span><span style="color: #ff0000;">lang</span><span style="color: #0000ff;">="en"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">meta </span><span style="color: #ff0000;">charset</span><span style="color: #0000ff;">="UTF-8"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>Title<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">src</span><span style="color: #0000ff;">="http://code.jquery.com/jquery-latest.js"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>


<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">button</span><span style="color: #0000ff;">&gt;</span>sendAjax<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">button</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">

{% csrf_token %}

</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">
    $(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">button</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).click(</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){


        $.ajax({
            url:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">/SendAjax/</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,
            type:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">POST</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,
            data:{</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">username</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">yuan</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">csrfmiddlewaretoken</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">:$(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">[name='csrfmiddlewaretoken']</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).val()},
            success:</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(data){
                alert(data)
            }
        })
    })
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">


==================================http://127.0.0.1:8002项目的views

def index(request):

    return render(request,"index.html")

from django.views.decorators.csrf import csrf_exempt

@csrf_exempt


def SendAjax(request):

    import json

    print("++++++++")

    return HttpResponse(json.dumps("hello2"))</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;当点击项目1的按钮时，发送了请求，但是会发现报错如下：</p>
<div class="cnblogs_code">
<pre>已拦截跨源请求：同源策略禁止读取位于 http://127.0.0.1:7766/SendAjax/ 的远程资源。（原因：CORS 头缺少 <span style="color: #800000;">'</span><span style="color: #800000;">Access-Control-Allow-Origin</span><span style="color: #800000;">'</span>）。</pre>
</div>
<p>但是注意，项目2中的访问已经发生了，说明是浏览器对非同源请求返回的结果做了拦截。</p>
</div>
<div class="para">
<h2>Jsonp</h2>
<div class="para">
<p>jsonp是json用来跨域的一个东西。原理是通过script标签的跨域特性来绕过同源策略。</p>
<p>思考：这算怎么回事？</p>
</div>
<div class="para">
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&lt;script src="http://code.jquery.com/jquery-latest.js"&gt;&lt;/script&gt;
</pre>
</div>
<p>&nbsp;借助script标签，实现跨域请求，示例：</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;"> =============================http://127.0.0.1:8001/index</span>


&lt;button&gt;ajax&lt;/button&gt;<span style="color: #000000;">
{</span>% csrf_token %<span style="color: #000000;">}

</span>&lt;script&gt;<span style="color: #000000;">
    function func(name){
        alert(name)
    }
</span>&lt;/script&gt;

&lt;script src=<span style="color: #800000;">"</span><span style="color: #800000;">http://127.0.0.1:7766/SendAjax/</span><span style="color: #800000;">"</span>&gt;&lt;/script&gt;


<span style="color: #008000;">#</span><span style="color: #008000;"> =============================http://127.0.0.1:8002/</span>
<span style="color: #0000ff;">from</span> django.views.decorators.csrf <span style="color: #0000ff;">import</span><span style="color: #000000;"> csrf_exempt

@csrf_exempt


</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> SendAjax(request):

    </span><span style="color: #0000ff;">import</span><span style="color: #000000;"> json

    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">++++++++</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    # dic={<span style="color: #008080;">"k1":<span style="color: #008080;">"v1"}</span></span>
    </span><span style="color: #0000ff;">return</span> HttpResponse(<span style="color: #800000;">"</span><span style="color: #800000;">func('yuan')</span><span style="color: #800000;">"</span>)  # <span style="color: #cc7832; font-weight: bold;">return HttpResponse(<span style="color: #008080;">"func('%s')"%json.dumps(dic))</span></span></pre>
</div>
<p>这其实就是JSONP的简单实现模式，或者说是JSONP的原型：创建一个回调函数，然后在远程服务上调用这个函数并且将JSON 数据形式作为参数传递，完成回调。</p>
<p>将JSON数据填充进回调函数，这就是JSONP的JSON+Padding的含义。</p>
<p>&nbsp; &nbsp; &nbsp; 一般情况下，我们希望这个script标签能够动态的调用，而不是像上面因为固定在html里面所以没等页面显示就执行了，很不灵活。我们可以通过javascript动态的创建script标签，这样我们就可以灵活调用远程服务了。</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">button </span><span style="color: #ff0000;">onclick</span><span style="color: #0000ff;">="f()"</span><span style="color: #0000ff;">&gt;</span>sendAjax<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">button</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
    <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> addScriptTag(src){
         </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> script </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> document.createElement(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">script</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">);
         script.setAttribute(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">type</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">text/javascript</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
         script.src </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> src;
         document.body.appendChild(script);
         document.body.removeChild(script);
    }


    </span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> func(name){
        alert(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">hello</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;">name)
    }

    </span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> f(){
         addScriptTag(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">http://127.0.0.1:7766/SendAjax/</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">)
    }
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>为了更加灵活，现在将你自己在客户端定义的回调函数的函数名传送给服务端，服务端则会返回以你定义的回调函数名的方法，将获取的json数据传入这个方法完成回调：</p>
<p>将8001的f()改写为：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:html;gutter:true;">function f(){
         addScriptTag("http://127.0.0.1:7766/SendAjax/?callbacks=func")
    }
</pre>
</div>
<p>8002的views改为：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">def SendAjax(request):

    import json

    dic={"k1":"v1"}

    print("callbacks:",request.GET.get("callbacks"))
    callbacks=request.GET.get("callbacks")

    return HttpResponse("%s('%s')"%(callbacks,json.dumps(dic)))
</pre>
</div>
<h2>jQuery对JSONP的实现</h2>
<h3>getJSON</h3>
<p>jQuery框架也当然支持JSONP，可以使用$.getJSON(url,[data],[callback])方法</p>
<p>8001的html改为：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">button </span><span style="color: #ff0000;">onclick</span><span style="color: #0000ff;">="f()"</span><span style="color: #0000ff;">&gt;</span>sendAjax<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">button</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>

    <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> f(){
          $.getJSON(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">http://127.0.0.1:7766/SendAjax/?callbacks=?</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(arg){
            alert(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">hello</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;">arg)
        });
    }
    
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>8002的views不改动。</p>
<p>结果是一样的，要注意的是在url的后面必须添加一个callback参数，这样getJSON方法才会知道是用JSONP方式去访问服务，callback后面的那个问号是内部自动生成的一个回调函数名。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 此外，如果说我们想指定自己的回调函数名，或者说服务上规定了固定回调函数名该怎么办呢？我们可以使用$.ajax方法来实现</p>
<h3>&nbsp;$.ajax</h3>
<p>8001的html改为：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>

    <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> f(){
          $.ajax({
                url:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">http://127.0.0.1:7766/SendAjax/</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,
                dataType:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">jsonp</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,
                jsonp: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">callbacks</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,
                jsonpCallback:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">SayHi</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">
           });

       }

    </span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> SayHi(arg){
                alert(arg);
            }

</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>8002的views不改动。</p>
<p><strong>当然，最简单的形式还是通过回调函数来处理：</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>

    <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> f(){

            $.ajax({
               url:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">http://127.0.0.1:7766/SendAjax/</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,
               dataType:</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">jsonp</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,            </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">必须有，告诉server，这次访问要的是一个jsonp的结果。</span>
<span style="background-color: #f5f5f5; color: #000000;">               jsonp: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">callbacks</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,          </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">jQuery帮助随机生成的：callbacks="wner"</span>
<span style="background-color: #f5f5f5; color: #000000;">               success:</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(data){
                   alert(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">hi </span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;">data)
              }
         });

       }

</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; <span style="color: #000000;"><span style="color: #000000;">jsonp: 'callbacks'<span style="color: #000000;">就是定义一个存放回调函数的键，jsonpCallback是前端定义好的回调函数方法名'SayHi'，server端接受callback键对应值后就可以在其中填充数据打包返回了;&nbsp;</span></span></span></p>
<p>jsonpCallback参数可以不定义，jquery会自动定义一个随机名发过去，那前端就得用回调函数来处理对应数据了。利用jQuery可以很方便的实现JSONP来进行跨域访问。　　</p>
<p><span style="color: #008080;">注意 JSONP一定是GET请求</span></p>
</div>
</div>
<h3 class="para">&nbsp;应用</h3>
<div class="cnblogs_code" onclick="cnblogs_code_show('dcf8a80b-88b4-422d-86bc-d6fbc08c5c54')"><img id="code_img_closed_dcf8a80b-88b4-422d-86bc-d6fbc08c5c54" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_dcf8a80b-88b4-422d-86bc-d6fbc08c5c54" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('dcf8a80b-88b4-422d-86bc-d6fbc08c5c54',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_dcf8a80b-88b4-422d-86bc-d6fbc08c5c54" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="button"</span><span style="color: #ff0000;"> onclick</span><span style="color: #0000ff;">="AjaxRequest()"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="跨域Ajax"</span> <span style="color: #0000ff;">/&gt;</span>


<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="container"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>


    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text/javascript"</span><span style="color: #0000ff;">&gt;</span>
        <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> AjaxRequest() {
            $.ajax({
                url: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">http://www.jxntv.cn/data/jmd-jxtv2.html?callback=list&amp;_=1454376870403</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,
                type: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">GET</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,
                dataType: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">jsonp</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,
                jsonp: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">callback</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,
                jsonpCallback: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">list</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,
                success: </span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> (data) {
                    
                    $.each(data.data,</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(i){
                        </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> item </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> data.data[i];
                        </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> str </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">&lt;p&gt;</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;"> item.week </span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">&lt;/p&gt;</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">;
                        $(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">#container</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">).append(str);
                        $.each(item.list,</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(j){
                            </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> temp </span><span style="background-color: #f5f5f5; color: #000000;">=</span> <span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">&lt;a href='</span><span style="background-color: #f5f5f5; color: #000000;">"</span> <span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;"> item.list[j].link </span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">'&gt;</span><span style="background-color: #f5f5f5; color: #000000;">"</span> <span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;"> item.list[j].name </span><span style="background-color: #f5f5f5; color: #000000;">+</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> &lt;/a&gt;&lt;br/&gt;</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">;
                            $(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">#container</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">).append(temp);
                        });
                        $(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">#container</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">).append(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">&lt;hr/&gt;</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
                    })

                }
            });
        }
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>　</p>
<p>　</p>
<p>&nbsp;</p>
<p style="margin-left: 60px;">&nbsp;</p>
<p style="margin-left: 60px;">&nbsp;</p>
<p style="margin-left: 60px;">&nbsp;</p>
<p style="margin-left: 60px;">&nbsp;</p>
<p>&nbsp;</p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>


		</div>
		<div class = "postDesc">posted @ <span id="post-date">2017-10-08 22:39</span> <a href='http://www.cnblogs.com/yuanchenqi/'>Yuan先生</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>) &nbsp;<a href="https://i.cnblogs.com/EditArticles.aspx?postid=7638956" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(7638956);return false;">收藏</a></div>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=262677,cb_entryId=7638956,cb_blogApp=currentBlogApp,cb_blogUserGuid='6d0ad0ce-3cb7-e511-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/10/8 22:39:00';loadViewCount(cb_entryId);var cb_postType=2;</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id='comment_form' class='commentform'>
<a name='commentform'></a>
<div id='divCommentShow'></div>
<div id='comment_nav'><span id='span_refresh_tips'></span><a href='javascript:void(0);' onclick='return RefreshCommentList();' id='lnk_RefreshComments' runat='server' clientidmode='Static'>刷新评论</a><a href='#' onclick='return RefreshPage();'>刷新页面</a><a href='#top'>返回顶部</a></div>
<div id='comment_form_container'></div>
<div class='ad_text_commentbox' id='ad_text_under_commentbox'></div>
<div id='ad_t2'></div>
<div id='opt_under_post'></div>
<div id='cnblogs_c1' class='c_ad_block'></div>
<div id='under_post_news'></div>
<div id='cnblogs_c2' class='c_ad_block'></div>
<div id='under_post_kb'></div>
<div id='HistoryToday' class='c_ad_block'></div>
<script type='text/javascript'>
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverAdT2();
    deliverAdC1();
    deliverAdC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   
</script>
</div>


	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright &copy;2017 Yuan先生
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->
<!--PageEndHtml Block Begin-->
<script language="javascript" type="text/javascript">
//生成目录索引列表
function GenerateContentList()
{
  var jquery_h1_list = $('#cnblogs_post_body h1').not('.catListTitle').not('#blogTitle h1');//如果你的章节标题不是h4,只需要将这里的h4换掉即可
  if(jquery_h1_list.length>0)
  {
    var content = '<a name="_labelTop"></a>';
    content	+= '<div id="navCategory">';
    content	+= '<p style="font-size:25px;color:#EE1289;"><i>知识预览</i></p>';
    content	+= '<ul id="sortChapter">';
    for(var i =0;i<jquery_h1_list.length;i++)
    {
      var go_to_top = '<div style="text-align: right"><a href="#_labelTop">回到顶部</a><a name="_label' + i + '"></a></div>';
      $(jquery_h1_list[i]).before(go_to_top);
      var li_content = '<li><a href="#_label' + i + '"style="color: #003366;text-decoration:none;font-size:18px">' + $(jquery_h1_list[i]).text() + '</a></li>';
      content += li_content;
    }
    content	+= '</ul>';
    content	+= '</div>';
    if($('#cnblogs_post_body').length != 0 )
    {
      $($('#cnblogs_post_body')[0]).prepend(content);
    }
  }	
}
GenerateContentList();
</script>
<!--PageEndHtml Block End-->
</body>
</html>
